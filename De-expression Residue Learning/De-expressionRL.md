### Facial Expression Recognition by De-expression Residue Learning  
#### Abstract
一个人的面部表情由表情成分和中性成分组成。这篇文章中，我们提出通过de-expression learning procedure提取表情成分信息的面部表情识别方法，叫做残余表情识别算法（De-expression Residue Learning，DeRL）。首先，通过cGAN训练一个生成模型。这个模型对于任何输入的人脸图像生成大致相当的中性脸。我们称这个过程为de-expression,因为这个生成模型筛选表情信息；然而，表情信息仍然记录在中间层。给定中性脸，不像以前使用像素级或者特征级不同来面部表情分类，我们的新方法学习生成模型的中间层残留得到残余表情。这种剩余表情很重要，因为它包含任何输入表情图片冗余在生成模型的表情成分。7种公开面部表情数据集在我们的实验中使用。两个数据集作为预训练（BU-4DFE 和 BP4D-spontaneous），DeRL方法在五个数据集上评估，CK+，Oulu-CASIA, MMI, BU-3DFE, and BP4D+.实验结果表明提出的方法表现优越。  
#### 1. Introduction  
在包括各种头部姿势，照明条件，分辨率和遮挡在内的各种成像条件下，已经对姿势和自发的面部表情进行了（FER）的研究。尽管在提高表情分类上取得了重大进展，当前的主要挑战来自个体差异的巨大变化，如年龄、性别、种族背景和个人差异。不同的人由于不同的个性和表达风格。只有最近的工作开始着手这个方面的工作，把个人年龄、性别、个性等方面考虑进面部表情分析。  
研究表明人类有能力认识面部表情通过将受试者的表情与同一受试者的参考表情（即中性表情）进行比较。换句话说，一个人脸表情可以用表情和中性表情组成。到现在为止，已有的一些工作利用了查询图像和中性面部图像的图像差异或特征差异来识别面部表情。然而，这个假定是中性表情是可获得的。事实是，中性表情一般不可获得。为了缓解这个问题，需要基于给定的表达输入来开发中性表达生成器。生成对抗模型（GAN）能解决这个问题。为了训练一个生成模型（generator），一个GAN框架利用其他的深度模型（discriminator）去和生成模型对抗，而不是为生成器定义一个常用的损失函数。判别器被设计用来区分生成器的采样和训练数据的采样；而生成器学习输出最大程度混淆判别器的样本。基本GAN的扩展是条件GAN（cGAN）,它能够通过额外条件变化来学习不同的上下文信息。现在的工作结合CNN和cGANs应用于很多应用，包括face generation, object reconstruction from edge maps 和 object attributes manipulation。  
![Fig1]()我们提出的（DeRL）。面部表情是中性的面部图像和表情成分的组合。我们提出的方法通过学习生成模式中的残余表情成分来识别面部表情。   
在这篇文章中，我们提出一种新的方法叫做残余表情学习（DeRL），通过提取表情成分来学习面部表情。如图一，给定一张任意表情面部图像，他的大致的中性表情通过训练生成模型生成。通过这个步骤，当表情成分被移除，主体的身份信息保持不变。我们称此为de-expression。尽管带有表情的图像输入“标准化”为中性表情输出，但被过滤出来的表情成分仍然“沉淀”在生成模型中。换句话说，在de-expression过程中，表情信息被记录在生成器中。沉淀是de-expression的残留，这恰是我们要用于表情分类的表情成分。   
与之前方法相比，使用表情图像和中性图像的像素级差异或特征水平差异，我们提出的DeRL框架学习剩余在生成模型的表情残留，试图减轻个体身份影响并提高面部表情识别的水平。这工作的贡献在两方面：  
1、我们提出新的方法学习表情通过de-expression。我们首先为查询图像训练一个生成模型以生成大致的中性脸；然后学习生成模型的残余（i.e.表情成分），缓解身份相关的变化问题。  
2、我们提出的方法能处理有各种风格和种族背景的无意识表情（spontaneous expressions）和姿势表情（posed expressions）。它成功的提高了在个别数据集(individual datasets)和交叉验证数据集（cross-dataset validation）的性能，比最先进的方法表现好。  
#### 2. Related Work  
之前工作表明使用中性面部图像对面部表情识别有益。从像素级或特征级的相应面部表情图像中减去中性面部图像可以增强面部表情同时减少类内变化。  
Bazzo et al.通过应用Gabor小波识别减去平均中性脸的面部表情取得了好的识别率。Zafeiriou etal.对于不同的图片应用稀疏面部表情表示，从表情中国呢减去中性图片得到的，表明使用中性图像倾向于加强移动的面部部分。Lee at al.从训练集中生成几个类内变化的图像（包括中性），然后减去查找面部图像获得不同的图像。不同的图像用来增强一张query face image的面部表情。Kim et al.在网络中采用对比表示来提取a query face image 和 a neutral face image的差异.   
然而，先前的工作假设同一主体的表情的中性表情总是可获得的，这是不现实的。根据需要从任何输入表情生成中性脸。GAN在这方面表现很成功。Gauthier尝试使用cGANs生成特定属性的人脸。Radford et al. 尝试使用CNNs扩展GAN来建模图像并且引入生成对抗网络（DCGAN）的结构。这项工作展示了用向量算法操纵生成面部样本的能力。Isola et al.利用条件对抗网络进行图像到图像的转换，并展示许多有趣的应用，如从地图生成航空照片，从边缘地图重建对象，并对图像着色。Zhou et al.使用cGAN来合成来自中性面部的面部表情图像。  
到目前为止，已经使用了查询图像和生成的中性图像的图像或特征差异，但是没有探索生成模型中记录的任何隐式表情信息。我们提出探索嵌入在生成器的表情信息，并直接从中间层提取表情成分。事实上，这些信息在de-expression过程被生成器“过滤”，然而他的表示（或残留）仍然沉淀在生成模型，因此成为表示表情成分的关键信息。我们提出的方法不是使用查询图像和生成的中性人脸图像来训练具有对比损失函数的深层模型，而是着重于学习生成模型的残差，从而有效地捕获表情成分并对个体变化更稳健。  
#### 3. Proposed Method - DeRL  
![Fig2]()  
我们提出的DeRL方法的结构如图2所示。包含两个学习过程：
第一步通过cGANs学习中性脸生成器。  
第二步从生成器中间层学习。  
输入图像对，$<I_input,I_target>$


